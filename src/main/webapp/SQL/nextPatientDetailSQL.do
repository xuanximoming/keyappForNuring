#
#Sun Oct 15 22:08:03 CST 2017
SQL=SELECT DISTINCT A.PATIENT_ID AS brid,\r\n                B.VISIT_ID AS zyid,\r\n                A.NAME AS brname,\r\n                (SELECT BED_LABEL\r\n                   FROM BED_REC\r\n                  WHERE BED_NO \= B.bed_no\r\n                    AND ward_code \= B.Ward_Code) AS chuang,\r\n                A.SEX AS sex,\r\n                B.DOCTOR_IN_CHARGE AS ZHUYI,\r\n                to_char(A.DATE_OF_BIRTH, 'yyyy-mm-dd') AS BIRTH,\r\n                to_char(B.ADMISSION_DATE_TIME, 'yyyy-mm-dd') AS ZYDATE,\r\n                (SELECT DEPT_NAME\r\n                   FROM DEPT_DICT\r\n                  WHERE DEPT_CODE \= B.DEPT_CODE) AS BINGQU,\r\n                B.DIAGNOSIS AS zhenduan,\r\n                A.CHARGE_TYPE AS feibie,\r\n                (B.PREPAYMENTS - B.TOTAL_CHARGES) AS feiyue,\r\n                (CASE\r\n                  WHEN (SELECT NURSING_CLASS_NAME\r\n                          FROM NURSING_CLASS_DICT\r\n                         WHERE NURSING_CLASS_CODE \= B.NURSING_CLASS) IS NULL THEN\r\n                   '-'\r\n                  ELSE\r\n                   (SELECT NURSING_CLASS_NAME\r\n                      FROM NURSING_CLASS_DICT\r\n                     WHERE NURSING_CLASS_CODE \= B.NURSING_CLASS)\r\n                END) AS HULIDJ\r\n  FROM PAT_MASTER_INDEX A,\r\n       (SELECT *\r\n          FROM pats_in_hospital\r\n         WHERE WARD_CODE \= '%s'\r\n           AND bed_no > '%s'\r\n         ORDER BY bed_no ASC) B\r\n WHERE A.PATIENT_ID \= B.PATIENT_ID\r\n   AND rownum \= 1\r\n
